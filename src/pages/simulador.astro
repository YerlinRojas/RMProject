---
import Layout from "../layouts/Layout.astro";
import texturas from '../../public/data/simulador.json';
import TextureViewer from '../components/TextureViewer.astro';
import TextureMenu from '../components/TextureMenu.astro';

---
    <Layout title="simulador">
        <script is:inline src="https://unpkg.com/alpinejs" defer></script>
        <main class="flex h-screen overflow-hidden" x-data="{ selectedTexture: '' }">
            <!-- Imagen de la casa (80%) -->
            <section class="flex-1 bg-gray-200 flex items-center justify-center p-8">
              <TextureViewer />
            </section>
      
            <!-- Menú lateral derecho -->
            <aside class="w-1/5 bg-gray-100 p-4 overflow-y-auto border-l border-gray-300">
              {texturas.map((categoria) => (
                <TextureMenu
                  categoria={categoria}
                  onSelect={(url) => {
                    // esto no funciona directo en Astro: usamos un truco más abajo
                  }}
                />
              ))}
            </aside>
          </main>
          <script is:inline>
            window.setTexture = (url) => {
              const textureLayer = document.querySelector('.texture-layer');
              if (textureLayer) {
                textureLayer.style.backgroundImage = `url(${url})`;
              }
            };
          </script>
    </Layout>
